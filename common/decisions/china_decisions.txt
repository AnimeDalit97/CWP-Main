propose_armistice_for_chinese_civil_war = {
	is_shown = {
		and = {
			exists = c:PRC
			exists = C:ROC
		}
		OR = {
			this ?= c:PRC
			this ?= c:ROC
		}
		NOT = { has_global_variable = china_armistice_proposed }
	}

	possible = {
		OR = {
			this ?= c:PRC
			this ?= c:ROC
		}
		NOT = { has_global_variable = china_armistice_proposed }
	}

	when_taken = {
		############### outdated since controller exists
		#if = {
		#	limit = {
		#		is_ai = no
		#		this ?= c:PRC
		#	}
		#	#c:ROC = { trigger_event = { id = china_frontline_saving_events.6 popup = yes } }
		#	trigger_event = { id = china_frontline_saving_events.2 popup = yes }
		#}
		#if = {
		#	limit = {
		#		is_ai = no
		#		this ?= c:ROC
		#	}
		#	#c:PRC = { trigger_event = { id = china_frontline_saving_events.7 popup = yes } }
		#	trigger_event = { id = china_frontline_saving_events.3 popup = yes }
		#}
		set_global_variable = china_armistice_proposed
		if = {
			limit = {
				this ?= c:PRC
			}
			c:ROC ?= { trigger_event = { id = china_frontline_saving_events.5 days = 0 popup = yes } }
		}
		if = {
			limit = {
				this ?= c:ROC
			}
			c:PRC ?= { trigger_event = { id = china_frontline_saving_events.4 days = 0 popup = yes } }
		}
		############### outdated since controller exists
		#if = {
		#	limit = {
		#		c:PRC ?= { is_ai = yes }
		#		c:ROC ?= { is_ai = yes }
		#		this ?= c:ROC
		#	}
		#	random_country = {
		#		limit = { is_ai = no }
		#		trigger_event = { id = china_frontline_saving_events.1 popup = yes }
		#	}
		#}
		#if = {
		#	limit = {
		#		c:PRC ?= { is_ai = yes }
		#		c:ROC ?= { is_ai = yes }
		#		this ?= c:PRC
		#	}
		#	random_country = {
		#		limit = { is_ai = no }
		#		trigger_event = { id = china_frontline_saving_events.100 popup = yes }
		#	}
		#}
	}

	ai_chance = {
		base = -100
		#modifier = {
		#	trigger = {
		#		this ?= c:ROC
		#	}
		#	add = 200
		#}
		modifier = {
			trigger = {
				year >= 1952
			}
			add = 200
		}
	}
}

roc_great_retreat = {
	is_shown = {
		this ?= c:ROC
		c:PRC = {
			has_war_with = ROOT
		}
		not = {
			has_variable = great_retreat
		}
	}

	possible = {
		not = {
			has_variable = great_retreat
		}
		any_scope_war = {
			is_war_participant = ROOT
			is_war_participant = c:PRC
		    has_war_support = {
		        target = ROOT
		        value < 30
		    }
		}
	}

	when_taken = {
		this = {
			set_variable = great_retreat
		}
		s:STATE_SUZHOU.region_state:ROC = {
			set_state_owner = c:PRC
		}
		s:STATE_ZHILI.region_state:ROC = {
			set_state_owner = c:PRC
		}
		s:STATE_NORTHERN_ANHUI.region_state:ROC = {
			set_state_owner = c:PRC
		}
		s:STATE_SOUTHERN_ANHUI.region_state:ROC = {
			set_state_owner = c:PRC
		}
		s:STATE_EASTERN_HUBEI.region_state:ROC = {
			set_state_owner = c:PRC
		}
		s:STATE_WESTERN_HUBEI.region_state:ROC = {
			set_state_owner = c:PRC
		}
		s:STATE_HUNAN.region_state:ROC = {
			set_state_owner = c:PRC
		}
		s:STATE_JIANGXI.region_state:ROC = {
			set_state_owner = c:PRC
		}
		s:STATE_DZUNGARIA.region_state:ROC = {
			set_state_owner = c:PRC
		}
		s:STATE_TIANSHAN.region_state:ROC = {
			set_state_owner = c:PRC
		}
		s:STATE_SICHUAN.region_state:ROC = {
			set_state_owner = c:PRC
		}
		s:STATE_YUNNAN.region_state:ROC = {
			set_state_owner = c:PRC
		}
		s:STATE_GUIZHOU.region_state:ROC = {
			set_state_owner = c:PRC
		}
		s:STATE_SHAOZHOU.region_state:ROC = {
			set_state_owner = c:PRC
		}
		s:STATE_ALXA.region_state:ROC = {
			set_state_owner = c:PRC
		}
		s:STATE_GUANGXI.region_state:ROC = {
			set_state_owner = c:PRC
		}
		s:STATE_NINGXIA.region_state:ROC = {
			set_state_owner = c:PRC
		}
		s:STATE_GANSU.region_state:ROC = {
			set_state_owner = c:PRC
		}
		s:STATE_XIAN.region_state:ROC = {
			set_state_owner = c:PRC
		}
		s:STATE_QINGHAI.region_state:ROC = {
			set_state_owner = c:PRC
		}
		s:STATE_CHONGQING.region_state:ROC = {
			set_state_owner = c:PRC
		}
		s:STATE_GUANGDONG.region_state:ROC = {
			set_state_owner = c:PRC
		}
		s:STATE_FUJIAN.region_state:ROC = {
			set_state_owner = c:PRC
		}
		s:STATE_ZHEJIANG.region_state:ROC = {
			set_state_owner = c:PRC
		}
		s:STATE_NANJING.region_state:ROC = {
			set_state_owner = c:PRC
		}
		s:STATE_HENAN.region_state:ROC = {
			set_state_owner = c:PRC
		}
		s:STATE_GUANGDONG.region_state:ROC = {
			set_state_owner = c:PRC
		}
	}

	ai_chance = { # TODO, does not work
		base = -10
		modifier = {
			trigger = {
				any_scope_war = {
					has_war_support = {
						target = ROOT
						value < 20
					}
				}
			}
			add = 50
		}
	}
}