run_unsc_sgui_toggle = {
    # Used to run a scripted gui on a country
    # VAR = Variable to toggle with effect
    every_country = {
        limit = {
            is_ai = no
            exists = scope:player_credit
        }
        set_local_variable = {
            name = upper
            value = {
                add = credit
                add = 1
            }
        }
        set_local_variable = {
            name = lower
            value = {
                add = credit
                subtract = 1
            }
        }
        if = {
            limit = {
                # scope:player_credit = GetPlayer.GetMaxCredit
                exists = local_var:lower
                exists = local_var:upper
                # Check range because of rounding, i think
                scope:player_credit >= local_var:lower
                scope:player_credit <= local_var:upper
            }
            every_country = {
                limit = {
                    has_variable = unsc_member
                }
                if = {
                    limit = {
                        is_target_in_global_variable_list = {
                            name = $VAR$
                            target = this
                        }
                    }
#                    prev = {
#                        clear_global_variable_list = $VAR$
#                    }
                }
                else = {
                    prev = {
                        add_to_global_variable_list = {
                            name = $VAR$
                            target = prev
                        }
                    }
                }
            }
        }
        remove_local_variable = lower
        remove_local_variable = upper
    }
}
